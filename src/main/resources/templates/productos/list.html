<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Productos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            border-radius: 1rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .qr-thumb {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
            border: 1px solid #ddd;
        }
        .table th, .table td {
            vertical-align: middle;
        }
        .btn-sm {
            min-width: 70px;
        }
    </style>
</head>

<body>
<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>ðŸ“¦ Productos</h2>
        <div class="d-flex justify-content-end">
            <a href="/productos/nuevo" class="btn btn-success me-2">+ Nuevo Producto</a>
            <a href="/home" class="btn btn-secondary">Cancelar</a>
        </div>
    </div>

    <div class="card p-3">
        <div class="table-responsive">
            <table class="table table-striped align-middle mb-0">
                <thead class="table-light">
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Precio</th>
                    <th>Stock</th>
                    <th>CÃ³digo de Barra</th>
                    <th>QR</th>
                    <th>Acciones</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="p : ${productos}">
                    <td th:text="${p.id}">1</td>
                    <td th:text="${p.name}">Nombre</td>
                    <td th:text="${#numbers.formatDecimal(p.price, 1, 'COMMA', 2, 'POINT')}">$0.00</td>
                    <td th:text="${p.stock}">10</td>
                    <!-- Mostrar el cÃ³digo de barra real -->
                    <td th:text="${p.codigo}">123ABC</td>
                    <!-- Mostrar el QR como imagen -->
                    <td>
                        <img th:src="@{|/productos/${p.id}/qr|}" alt="QR" class="qr-thumb"/>
                    </td>
                    <td>
                        <a th:href="@{|/productos/editar/${p.id}|}" class="btn btn-primary btn-sm me-1">Editar</a>
                        <a th:href="@{|/productos/eliminar/${p.id}|}" class="btn btn-danger btn-sm"
                           onclick="return confirm('Â¿Eliminar producto?')">Eliminar</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>


    <!-- SweetAlert2 -->
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    const mensaje = /*[[${mensaje}]]*/ null;
    const tipo = /*[[${tipo}]]*/ 'success';

    if (mensaje) {
        let iconColor = '#28a745';
        let bgColor = '#f0f0f0'; // Gris suave de fondo
        let textColor = '#212529';
        let borderColor = '#d3d3d3';

        if (tipo === 'error') {
            iconColor = '#dc3545';
            textColor = '#58151c';
            borderColor = '#f5c2c7';
        } else if (tipo === 'warning') {
            iconColor = '#ffc107';
            textColor = '#664d03';
            borderColor = '#ffecb5';
        } else if (tipo === 'success') {
            iconColor = '#198754';
            textColor = '#0f5132';
            borderColor = '#badbcc';
        }

        Swal.fire({
            toast: true,
            position: 'top-end',
            icon: tipo,
            title: mensaje,
            showConfirmButton: false,
            timer: 2800,
            timerProgressBar: true,
            background: bgColor,
            color: textColor,
            iconColor: iconColor,
            customClass: {
                popup: 'shadow-lg rounded-4 border border-2',
                title: 'fw-semibold'
            },
            didOpen: (toast) => {
                toast.style.borderColor = borderColor;
                toast.addEventListener('mouseenter', Swal.stopTimer);
                toast.addEventListener('mouseleave', Swal.resumeTimer);
            },
            showClass: {
                popup: 'animate__animated animate__fadeInDown'
            },
            hideClass: {
                popup: 'animate__animated animate__fadeOutUp'
            }
        });
    }
    /*]]>*/
</script>

<!-- Animaciones de entrada/salida -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>


</body>
</html>

